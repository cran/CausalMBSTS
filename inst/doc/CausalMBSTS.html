<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Working example of causal inference with CausalMBSTS package</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Working example of causal inference with CausalMBSTS package</h1>



<p>The example below shows how to use CausalMBSTS to infer the effect of an intervention on a multivariate time series. First, we need to generate some random data and a fictional intervention date. To keep the interpretation simple, assume we have weekly sales counts from two related products (winter wool hats and gloves) and that, say, on February 27, 2020 the store manager introduced a big price discount on all gloves to boost sales.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(CausalMBSTS)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Loading required package: KFAS</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Please cite KFAS in publications by using: </span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   Jouni Helske (2017). KFAS: Exponential Family State Space Models in R. Journal of Statistical Software, 78(10), 1-39. doi:10.18637/jss.v078.i10.</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Registered S3 method overwritten by &#39;quantmod&#39;:</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   method            from</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   as.zoo.data.frame zoo</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Set seed &amp; random data generation</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>,<span class="at">to =</span> <span class="dv">4</span><span class="sc">*</span>pi, <span class="at">length.out=</span><span class="dv">300</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="dv">3</span><span class="sc">*</span><span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>t)<span class="sc">+</span><span class="fu">rnorm</span>(<span class="dv">300</span>), <span class="dv">2</span><span class="sc">*</span><span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>t) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">300</span>))</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>dates <span class="ot">&lt;-</span> <span class="fu">seq.Date</span>(<span class="at">from =</span> <span class="fu">as.Date</span>(<span class="st">&quot;2015-01-01&quot;</span>), <span class="at">by =</span> <span class="st">&quot;week&quot;</span>, <span class="at">length.out=</span><span class="dv">300</span>)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>int.date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">&quot;2020-02-27&quot;</span>)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>y[dates <span class="sc">&gt;=</span> int.date,] <span class="ot">&lt;-</span> y[dates <span class="sc">&gt;=</span> int.date,]<span class="sc">+</span><span class="dv">2</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Some plots</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">y =</span> y[,<span class="dv">1</span>], <span class="at">x=</span>dates, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">col=</span><span class="st">&quot;cadetblue&quot;</span>)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">y =</span> y[,<span class="dv">2</span>], <span class="at">x =</span> dates, <span class="at">col =</span> <span class="st">&quot;orange&quot;</span>)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span>int.date, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From the plots of the two time series it is possible to notice a clear cyclical pattern with a period of approximately 1.5 years, equivalent to 75 weeks. Thus, we can try to estimate a model with two subcomponents: trend and cycle. To speed up computations, we set <tt>niter = 100</tt> but we recommend to do at least 1000 iterations and check the convergence of the Markov chain.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Causal effect estimation</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>causal<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">CausalMBSTS</span>(y, <span class="at">components =</span> <span class="fu">c</span>(<span class="st">&quot;trend&quot;</span>, <span class="st">&quot;cycle&quot;</span>), <span class="at">cycle.period =</span> <span class="dv">75</span>,</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">dates =</span> dates, <span class="at">int.date =</span> int.date, <span class="at">s0.r =</span> <span class="fl">0.01</span><span class="sc">*</span><span class="fu">diag</span>(<span class="dv">2</span>),</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">s0.eps =</span> <span class="fl">0.1</span><span class="sc">*</span><span class="fu">diag</span>(<span class="dv">2</span>), <span class="at">niter =</span> <span class="dv">100</span>, <span class="at">burn =</span> <span class="dv">10</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 20</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 30</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 40</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 50</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 60</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 70</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 80</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 90</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 100</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(causal<span class="fl">.2</span>)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Results for horizon_default:</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Avg. Effect          95% CI Cumulative Effect             95% CI</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; y1      2.3729 (0.9588,4.2757)           73.5602 (29.7232,132.5454)</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; y2      2.3810 (0.7609,4.2882)           73.8125 (23.5874,132.9332)</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    Bayesian p-value Prob. of a causal effect (%)</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; y1            0.011                      98.9011</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; y2            0.022                      97.8022</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Causal effect plot</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>oldpar <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">no.readonly =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(causal<span class="fl">.2</span>, <span class="at">int.date =</span> int.date, <span class="at">type =</span> <span class="st">&quot;impact&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Observed sales vs counterfactual sales plot</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(causal<span class="fl">.2</span>, <span class="at">int.date =</span> int.date, <span class="at">type =</span> <span class="st">&quot;forecast&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The results show a significant causal effect of the intervention on the sales of both products: on average, sales of gloves and hats increased of 2 units every week; at the end of the analysis period, the sales attributable to the discount amounted to approximately 74 units for each product.</p>
<p>The Bayesian p-value reported in the summary measures to what extent this result is due to chance. It is computed as the proportion of times that the cumulative sum of sales exceeds the observed sum; thus, a huge number indicate that the counterfactual sales are often higher than the observed sales after the discount, which clearly contradicts the hypothesis of a positive causal effect. In this case, the p-values are very small (0.011 and 0.022), yielding a probability of a causal effect around 98 % for both the time series.</p>
<p>Before reporting the results of any analysis based on a parametric model, it is recommended to check model adequacy. In a Bayesian framework, this can be done with posterior predictive checks.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Posterior predictive checks</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>)) ; <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>))</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(causal<span class="fl">.2</span>, <span class="at">int.date =</span> int.date, <span class="at">type =</span> <span class="st">&quot;ppchecks&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Starting from the left, the above plots show: the density of observed data vs.the posterior predictive mean (good overlap means that the model fits the data); ii) observed maximum compared to the distribution of the maximum from the posterior draws (extreme p-values indicate that the model produces extreme observations); iii) Normal QQ-Plot of standardized residuals; iv) autocorrelation function of standardized residuals. In this case, the posterior predictive checks are in favor of the model, but it is also important to check the convergence of the Markov chain (for illustration purposes, only the trace plots of the variance-covariance matrices of the observation and trend disturbances are displayed).</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Trace plots</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>)) ; <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>mcmc <span class="ot">&lt;-</span> causal<span class="fl">.2</span><span class="sc">$</span>mcmc</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mcmc<span class="sc">$</span>Sigma.eps[<span class="dv">1</span>,<span class="dv">1</span>,], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Variance of obs residuals Y1&quot;</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mcmc<span class="sc">$</span>Sigma.eps[<span class="dv">2</span>,<span class="dv">2</span>,], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Variance of obs residuals Y2&quot;</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mcmc<span class="sc">$</span>Sigma.eps[<span class="dv">1</span>,<span class="dv">2</span>,], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Covariance of obs residuals&quot;</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mcmc<span class="sc">$</span>Sigma.r[<span class="dv">1</span>,<span class="dv">1</span>,], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Variance of trend residuals Y1&quot;</span>)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mcmc<span class="sc">$</span>Sigma.r[<span class="dv">2</span>,<span class="dv">2</span>,], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Variance of trend residuals Y2&quot;</span>)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mcmc<span class="sc">$</span>Sigma.r[<span class="dv">1</span>,<span class="dv">2</span>,], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Covariance of trend residuals&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The trace plots show that convergence is soon reached for the variance-covariance matrix of the observation disturbances, whereas the variance-covariance matrix of the trend disturbances doesnt seem to have converged. Thus, it would be better to repeat the above analysis with a higher number of iterations.</p>
<p>The second example shows how to use CausalMBSTS to forecast the evolution of a multivariate time series. In line with the above example, lets assume that at the end of August 2019 the store manager wants to predict future sales of gloves and hats for the entire winter season (approximately 26 weeks) before placing an order to the suppliers. First, we create an MBSTS model (the same as the one above) and then we use this model to forecast sales.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set seed &amp; random data generation</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>,<span class="at">to =</span> <span class="dv">4</span><span class="sc">*</span>pi, <span class="at">length.out=</span><span class="dv">222</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="dv">3</span><span class="sc">*</span><span class="fu">sin</span>(<span class="dv">2</span><span class="sc">*</span>t)<span class="sc">+</span><span class="fu">rnorm</span>(<span class="dv">222</span>), <span class="dv">2</span><span class="sc">*</span><span class="fu">cos</span>(<span class="dv">2</span><span class="sc">*</span>t) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">222</span>))</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>dates <span class="ot">&lt;-</span> <span class="fu">seq.Date</span>(<span class="at">from =</span> <span class="fu">as.Date</span>(<span class="st">&quot;2015-06-01&quot;</span>), <span class="at">by =</span> <span class="st">&quot;week&quot;</span>, <span class="at">length.out=</span><span class="dv">222</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co"># MBSTS model definition</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>sales_model <span class="ot">&lt;-</span> <span class="fu">as.mbsts</span>(y, <span class="at">components =</span> <span class="fu">c</span>(<span class="st">&quot;trend&quot;</span>, <span class="st">&quot;cycle&quot;</span>), <span class="at">cycle.period =</span> <span class="dv">75</span>,</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>                        <span class="at">s0.r =</span> <span class="fl">0.01</span><span class="sc">*</span><span class="fu">diag</span>(<span class="dv">2</span>), <span class="at">s0.eps =</span> <span class="fl">0.1</span><span class="sc">*</span><span class="fu">diag</span>(<span class="dv">2</span>), <span class="at">niter =</span> <span class="dv">100</span>, <span class="at">burn =</span> <span class="dv">10</span>) </span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 10</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 20</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 30</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 40</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 50</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 60</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 70</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 80</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 90</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 100</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Prediction step</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(sales_model, <span class="at">steps.ahead =</span> <span class="dv">26</span>)</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Some plots</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>y.mean <span class="ot">&lt;-</span> <span class="fu">apply</span>(pred<span class="sc">$</span>post.pred,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),mean)</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>new.dates <span class="ot">&lt;-</span> <span class="fu">seq.Date</span>(<span class="at">from =</span> <span class="fu">as.Date</span>(<span class="st">&quot;2015-06-01&quot;</span>), <span class="at">by =</span> <span class="st">&quot;week&quot;</span>, <span class="at">length.out=</span><span class="dv">248</span>)</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">y =</span> y.mean[,<span class="dv">1</span>], <span class="at">x =</span> new.dates, <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">col=</span><span class="st">&quot;cadetblue&quot;</span>)</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">y =</span> y.mean[,<span class="dv">2</span>], <span class="at">x =</span> new.dates, <span class="at">col =</span> <span class="st">&quot;orange&quot;</span>)</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>( <span class="at">v =</span> dates[<span class="dv">222</span>], <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(oldpar)</span></code></pre></div>
<div id="further-readings" class="section level2">
<h2>Further readings</h2>
<p>Menchetti &amp; Bojinov (2020), Estimating causal effects in the presence of partial interference using multivariate Bayesian structural time series models <a href="https://arxiv.org/abs/2006.12269" class="uri">https://arxiv.org/abs/2006.12269</a></p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
